---
layout: post
title: "IN Operator"
description: "IN Operator"
category: "5. OData Features"
---

# Overview

The IN operator is a [new feature](http://docs.oasis-open.org/odata/new-in-odata/v4.01/cn01/new-in-odata-v4.01-cn01.html#_Toc485385090 "new feature") in OData 4.01 that enables a shorthand way of writing multiple EQ expressions joined by OR. For example,

`GET /service/Products?$filter=Name eq 'Milk' or Name eq 'Cheese' or Name eq 'Donut'`

can become

`GET /service/Products?$filter=Name in ('Milk', 'Cheese', 'Donut')`

Of the binary expression invoking IN, the left operand must be a single value and the right operand must be a comma-separated list of primitive values or a single expression that resolves to a collection; the expression returns true if the left operand is a member of the right operand.

# Usage

The `IN` operator is used in expressions that resolve to a boolean. Common use would be with `$filter` and it can also be used for `$orderby`. Below are examples using `$filter` with the `SampleEdmModel`.

## Model

```xml
<edmx:Edmx Version="4.0" xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx">
  <edmx:DataServices>
    <Schema Namespace="Fully.Qualified.Namespace" xmlns="http://docs.oasis-open.org/odata/ns/edm" Alias="SampleEdmModel">
      <EntityContainer Name="Context">
        <EntityType Name="Product">
          <Key>
            <PropertyRef Name="Name" />
          </Key>
          <Property Name="Name" Type="Edm.String" Nullable="false" />
          <NavigationProperty Name="ShipToAddress" Type="Fully.Qualified.Namespace.Address" />
          <NavigationProperty Name="MyShippers" Type="Fully.Qualified.Namespace.Shipper" />
        </EntityType>
        <EntityType Name="Address">
          <Key>
            <PropertyRef Name="Name" />
          </Key>
          <Property Name="Name" Type="Edm.String" Nullable="false" />
          <Property Name="CountryCode" Type="Edm.String" Nullable="false" />
        </EntityType>
        <EntityType Name="Shipper">
          <Key>
            <PropertyRef Name="Name" />
          </Key>
          <Property Name="Name" Type="Edm.String" Nullable="false" />
          <Property Name="Regions" Type="Collection(Edm.String)" Nullable="false" />
        </EntityType>
        <EntitySet Name="Products" EntityType="Fully.Qualified.Namespace.Product" />
        <Function Name="MostPopularItemNames" IsComposable="true">
          <ReturnType Type="Collection(Edm.String)" />
        </Function>
      </EntityContainer>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

## Code

```csharp
using System;                       // For Uri
using Microsoft.OData.Edm;          // For SampleEdmModel
using Microsoft.OData.UriParser;    // For ODataUriParser and FilterClause

namespace InOperatorSamples
{
    public class Samples
    {
        public void StaticCollectionWithParentheses()
        {
            ODataUriParser parser = new ODataUriParser(SampleEdmModel, new Uri("http://serviceUri/"), new Uri("http://serviceUri/Products?$filter=Name in ('Milk', 'Cheese')"));
            FilterClause filter = parser.ParseFilter();
            InNode inNode = filter.Expression as InNode;
            SingleValuePropertyAccessNode singleValueNode = inNode?.Left;
            CollectionConstantNode collectionNode = inNode?.Right;
        }

        public void CollectionAsExpression()
        {
            ODataUriParser parser = new ODataUriParser(SampleEdmModel, new Uri("http://serviceUri/"), new Uri("http://serviceUri/Products?$filter=Name in RelevantProductNames"));
            FilterClause filter = parser.ParseFilter();
            InNode inNode = filter.Expression as InNode;
            SingleValuePropertyAccessNode singleValueNode = inNode?.Left;
            CollectionPropertyAccessNode collectionNode = inNode?.Right;
        }

        public void NavigationProperties()
        {
            ODataUriParser parser = new ODataUriParser(SampleEdmModel, new Uri("http://serviceUri/"), new Uri("http://serviceUri/Products?$filter=ShipToAddress/CountryCode in MyShippers/Regions"));
            FilterClause filter = parser.ParseFilter();
            InNode inNode = filter.Expression as InNode;
            SingleNavigationNode singleValueNode = inNode?.Left;
            CollectionNavigationNode collectionNode = inNode?.Right;
        }

        public void BoundFunction()
        {
            ODataUriParser parser = new ODataUriParser(SampleEdmModel, new Uri("http://serviceUri/"), new Uri("http://serviceUri/Products?$filter=Name in Fully.Qualified.Namespace.MostPopularItemNames"));
            FilterClause filter = parser.ParseFilter();
            InNode inNode = filter.Expression as InNode;
            SingleValueFunctionCallNode singleValueNode = inNode?.Left;
            CollectionResourceFunctionCallNode collectionNode = inNode?.Right;
        }
    }
}
```

## Remarks

Having successfully parsed the `$filter` expression, the `FilterClause` will have an `Expression` member which can be casted to an `InNode` object. The members of InNode `Left` and `Right` represent `SingleValueNode` and `CollectionNode` respectively. From there, it is up to the user to do whatever they would like with the parsed information from the `InNode`. As shown in the code samples, it may be in the user's best interest to downcast the `SingleValueNode` and `CollectionNode` to subclasses to access additional properties.